# Day 33: 生成式 AI 的起點 - GAN (Generative Adversarial Networks)

## 1. 前言：從「判斷」到「創造」
在過去的 32 天，我們學的都是 **Discriminative AI (判別式 AI)**：
*   這張圖是貓還是狗？(分類)
*   明天的房價是多少？(回歸)
*   圖中的公車在哪裡？(偵測)

今天，我們要進入一個全新的領域：**Generative AI (生成式 AI)**。
我們不再滿足於讓電腦「看懂」世界，我們希望它能「**創造**」世界。

而這一切的起點，就是 2014 年由 Ian Goodfellow 提出的 **GAN (生成對抗網路)**。

## 2. 核心概念：GAN 的博弈遊戲
GAN 的靈感來自於「**偽鈔製造者 vs 警察**」的貓捉老鼠遊戲。
它由兩個神經網路組成，彼此對抗 (Adversarial)：

### 2.1 兩個主角
1.  **Generator (生成器 $G$)**：
    *   **角色**：偽鈔製造者。
    *   **任務**：拼命製造「假圖片」，想辦法騙過警察。
    *   **輸入**：一組隨機雜訊 (Random Noise, $z$)。
    *   **輸出**：一張生成的假圖 ($G(z)$)。

2.  **Discriminator (判別器 $D$)**：
    *   **角色**：警察 / 鑑識專家。
    *   **任務**：拼命分辨「這是真圖」還是「這是假圖」。
    *   **輸入**：一張圖片 (可能是真的 $x$，也可能是假的 $G(z)$)。
    *   **輸出**：一個機率值 (0~1)，1 代表它是真的，0 代表它是假的。

### 2.2 運作流程 (The Loop)
這兩個網路會同時訓練，互相進步：
1.  **G 隨便畫**：一開始 $G$ 畫得很爛 (像雜訊)。
2.  **D 輕鬆抓**：$D$ 很容易就分出真假。
3.  **G 進步**：$G$ 發現被抓了，調整參數，畫得更像一點。
4.  **D 進步**：$D$ 發現 $G$ 變強了，自己也要提升鑑識能力，抓出更細微的破綻。
5.  **最終平衡 (Nash Equilibrium)**：
    *   $G$ 畫出的圖已經跟真圖一模一樣。
    *   $D$ 再也分不出來，對於任何一張圖都只能猜 50% (0.5)。
    *   這就是我們想要的結果！

## 3. 核心公式 (Min-Max Game)
GAN 的訓練過程可以用一個數學公式來表示，這是一個 **Min-Max** 的博弈過程：

$$
\min_G \max_D V(D, G) = \mathbb{E}_{x \sim p_{data}(x)} [\log D(x)] + \mathbb{E}_{z \sim p_{z}(z)} [\log (1 - D(G(z)))]
$$

> **💡 公式白話文**：
> *   **$D$ (警察) 想最大化 (Max) 分數**：
>     *   看到真圖 ($x$)，要說 Yes ($D(x) \approx 1$) $\rightarrow$ $\log D(x)$ 越大越好。
>     *   看到假圖 ($G(z)$)，要說 No ($D(G(z)) \approx 0$) $\rightarrow$ $1 - D(G(z))$ 越大越好。
> *   **$G$ (偽鈔犯) 想最小化 (Min) 分數**：
>     *   它控制不了真圖，只能控制假圖。
>     *   它希望 $D$ 認錯，把假圖當成真圖 ($D(G(z)) \approx 1$) $\rightarrow$ 讓 $\log(1 - D(G(z)))$ 越小越好 (負無窮大)。

## 4. 實戰：用 GAN 生成手寫數字 (MNIST)
我們將使用 PyTorch 建立一個簡單的 GAN，讓它學習寫數字 "0-9"。

### 4.1 安裝
```bash
pip install torch torchvision matplotlib
```

### 4.2 程式碼架構
完整程式碼請參考 `GAN_MNIST.py` (稍後建立)。

1.  **Generator**：Linear -> ReLU -> Linear -> Tanh (輸出 -1~1 的圖片)。
2.  **Discriminator**：Linear -> LeakyReLU -> Linear -> Sigmoid (輸出 0~1 的機率)。
3.  **Training Loop**：
    *   先訓練 $D$ (給真圖標 1，給假圖標 0)。
    *   再訓練 $G$ (給假圖標 1，騙 $D$ 說這是真的)。

## 5. GAN 的應用與演進
GAN 開啟了生成式 AI 的大門，後來衍生出非常多強大的變形：

| 模型 | 特色 | 應用 |
| :--- | :--- | :--- |
| **DCGAN** | 使用 CNN 取代全連接層 | 生成高品質的人臉、臥室圖片。 |
| **CycleGAN** | 風格轉換 (不用成對資料) | 把「馬」變成「斑馬」、把「夏天」變成「冬天」。 |
| **StyleGAN** | NVIDIA 開發，超高解析度 | 生成逼真到可怕的假人臉 (ThisPersonDoesNotExist.com)。 |
| **SRGAN** | 超解析度 (Super Resolution) | 把模糊的低畫質影片變 4K 高畫質。 |

## 6. 下一關預告
GAN 雖然強大，但訓練很不穩定 (容易崩潰)。
Day 34 我們將介紹另一種生成模型：**AutoEncoder (自編碼器)** 與 **VAE (變分自編碼器)**，它們在異常檢測和圖像生成上也有獨特的地位。

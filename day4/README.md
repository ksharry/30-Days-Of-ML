# Day 04：邏輯回歸 (Logistic Regression) —— 生死一線間

## 0. 前情提要與故事線

在 Day 02 與 Day 03，我們處理的是房價預測（回歸問題）。但現實生活中，更多時候我們要面對的是 **「是非題」**：
* 這封信是垃圾郵件嗎？(Yes/No)
* 這位病人有癌症嗎？(Positive/Negative)
* **這位乘客能在鐵達尼號倖存嗎？(Survived/Died)**

今天，我們開啟新的故事線 —— **鐵達尼號生存預測**。我們將使用最經典的分類演算法：**邏輯回歸 (Logistic Regression)**。

---

## 1. 理論基礎：解構神秘公式

邏輯回歸的運作可以拆解成兩個步驟。你剛才看到的那些數學符號，其實每一個都對應到鐵達尼號的具體情境。

### 第一步：線性計分 (The Linear Score)
模型會先幫每位乘客算一個「生存分數」($z$)。這就是您提供的第一張圖的公式：

$$z = w_1 x_1 + w_2 x_2 + \dots + b$$

**變數對照表 (Variable Explanation)：**
* **$z$ (Score)**：這是模型算出來的**線性分數**。分數越高，代表存活機率越大；分數越低（負數），代表越可能死亡。
* **$x$ (Features)**：這是乘客的**特徵資料**。
    * $x_1$：可能是「性別 (Sex)」
    * $x_2$：可能是「年齡 (Age)」
    * $x_3$：可能是「艙等 (Pclass)」
* **$w$ (Weights)**：這是**權重**，也就是模型學到的「經驗」。
    * 如果 $w_1$ (性別權重) 是很大的**負數**，代表如果是男性，分數 $z$ 會被扣很多分。
    * 如果 $w_3$ (艙等權重) 是正數，代表艙等越高，分數加越多。
* **$b$ (Bias)**：**偏差值**。代表基礎分數，就像是考試的基本分。

### 第二步：機率轉換 (Sigmoid Function)
算出來的 $z$ 可能是 100 或是 -500，這不像是「機率」。我們需要把它壓縮到 **0 ~ 1** 之間。這就是您提供的第二張圖，著名的 **Sigmoid 函數**：

$$\sigma(z) = \frac{1}{1 + e^{-z}}$$

**變數對照表：**
* **$\sigma(z)$**：讀作 Sigma，這裡代表最終預測的 **生存機率 (Probability)**。範圍在 0% 到 100%。
* **$e$**：自然對數的底數 (約等於 2.718)。
* **$z$**：就是第一步算出來的那個「生存分數」。

**直觀理解：**
* 當分數 $z$ 很大時 (例如 10)，$e^{-10}$ 接近 0，結果接近 $\frac{1}{1} = 1$ (100% 存活)。
* 當分數 $z$ 很負時 (例如 -10)，$e^{10}$ 很大，分母變超大，結果接近 $0$ (0% 存活)。

---

## 2. 實驗設計：鐵達尼號數據 (The Titanic Experiment)

我們使用 Python 的 `sklearn` 來實作。為了讓電腦讀懂資料，我們做了兩件重要的預處理：

1.  **填補缺失值 (Missing Values)：** 很多乘客的年齡是空的，我們用「中位數」填補，避免誤導模型。
2.  **獨熱編碼 (One-Hot Encoding)：** 電腦看不懂 "Male" 和 "Female"。我們將其轉換為數字。

### 2.1 混淆矩陣 (Confusion Matrix)

模型跑完後，準確率大約落在 **81%**。
* **TP (True Positive):** 模型猜他活，他也真的活了。
* **FN (False Negative):** 模型猜他會死，結果他奇蹟生還（遺憾的錯誤）。

---

## 3. 深度分析：誰最容易活下來？

透過觀察程式跑出來的 **係數圖 (Coefficients)**，我們發現了 $w$ (權重) 的秘密：

1.  **`Sex_male` (權重約 -2.5)**：這是負值最大的特徵。代表只要 $x$ (性別) 是男性，生存分數 $z$ 就會被重扣 2.5 分。這反映了「婦孺優先」。
2.  **`Pclass` (權重約 -0.9)**：也是負值。代表艙等數字越大 (3等艙)，生存機率越低。

---

## 4. 總結 (Conclusion)

邏輯回歸其實就是在做兩件事：
1.  算出一個分數 $z$（根據性別、年齡加權）。
2.  用 Sigmoid 函數把分數變成機率。

**Next Step:**
邏輯回歸畫出的這條「生死界線」是一條**直線**。但如果有更複雜的關係（例如：只有「小孩」和「老人」易存活，中間的壯年人易死亡），直線切不開怎麼辦？
**Day 05 - K-近鄰演算法 (KNN)** 將登場，我們將用「物以類聚」的方式來重新挑戰鐵達尼號！